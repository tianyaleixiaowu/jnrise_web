function getRequestSign(){var e=window.location.search;if(-1!=e.indexOf("?"))return e.substr(15)}function getRequest(){var e=window.location.search,n=new Object;if(-1!=e.indexOf("?"))for(var o=e.substr(1).split("&"),r=0;r<o.length;r++)o[r].split("=")[1].indexOf("%")<0?n[o[r].split("=")[0]]=unescape(o[r].split("=")[1]):n[o[r].split("=")[0]]=unescape(decodeURI(o[r].split("=")[1]));return n}function getRequestByName(e){var n=window.location.search,o="";if(-1!=n.indexOf("?"))for(var r=n.substr(1).split("&"),s=0;s<r.length;s++)-1!=r[s].indexOf(e+"=")&&(o=unescape(r[s].substring(e.length+1,r[s].length)));return o}function checkPhone(e){return!!/^1\d{10}$/.test(e)}$(function(){var e=getRequestByName("sign"),n=getRequestByName("openid");$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/enter",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{sign:e},dataType:"json",success:function(e){console.log(e)},error:function(e){console.log(e)}}),$("#send").click(function(){var e=$.trim($("#phone").val()),n=!0;if(""==e?(n=!1,$("#phone").parent(".form-item").addClass("error").find(".message").html("请输入您的手机号码")):checkPhone(e)?$("#phone").parent(".form-item").removeClass("error"):(n=!1,$("#phone").parent(".form-item").addClass("error").find(".message").html("请输入有效的11位电话号码")),n){$(this).addClass("send-disabled");var o=60;timer=setInterval(function(){$("#send").html(o+"秒重新发送"),0==--o&&(clearInterval(timer),$("#send").removeClass("send-disabled").html("重新发送"))},1e3),$.ajax({type:"GET",url:"https://mm.jnrise.cn:88/risewx/sms",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{mobile:e},dataType:"json",success:function(e){console.log(e)},error:function(e){console.log(e)}})}}),$("#submit").click(function(){var o=$.trim($("#phone").val()),r=$.trim($("#is-old").val()),s=$.trim($("#code").val()),t=!0;""==o?(t=!1,$("#phone").parent(".form-item").addClass("error").find(".message").html("请输入您的手机号码获取六一专属试听课")):checkPhone(o)?$("#phone").parent(".form-item").removeClass("error"):(t=!1,$("#phone").parent(".form-item").addClass("error").find(".message").html("请输入有效的11位电话号码")),""==r?(t=!1,$("#is-old").parent(".form-item").addClass("error")):$("#is-old").parent(".form-item").removeClass("error"),""==s?(t=!1,$("#code").parent(".form-item").addClass("error").find(".message").html("请输入您收到的短信验证码")):$.ajax({type:"GET",async:!1,url:"https://mm.jnrise.cn:88/risewx/sms/check",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{mobile:o,code:s},dataType:"json",success:function(e){console.log(e),-1==e.code?(t=!1,$("#code").parent(".form-item").addClass("error").find(".message").html("验证码输入有误")):$("#code").parent(".form-item").removeClass("error")},error:function(e){console.log(e)}}),t&&($.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/info",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{phone:o,name:name,age:0,gender:0,school:"",inRead:r,sign:e},dataType:"json",success:function(e){console.log(e),$(".modal").show(),$(".main .form-text").val("")},error:function(e){console.log(e)}}),$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/risewx/recommend",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{mobile:o,openId:n},dataType:"json",success:function(e){console.log(e)},error:function(e){console.log(e)}}))}),$(".modal").click(function(){$(this).hide()}),$("#is-old").focus(function(){$(this).find("option[value='']").hide()}),$("#is-old").blur(function(){$(this).find("option[value='']").show()})});