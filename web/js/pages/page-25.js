function getRequestByName(e){var n=window.location.search,o="";if(-1!=n.indexOf("?"))for(var t=n.substr(1).split("&"),r=0;r<t.length;r++)-1!=t[r].indexOf(e+"=")&&(o=unescape(t[r].substring(e.length+1,t[r].length)));return o}function checkPhone(e){return!!/^1(3|4|5|7|8)\d{9}$/.test(e)}function get_uuid(){var e=(new Date).getTime().toString();return uuid(8,16)+e.substr(6,8)}function uuid(e,n){var o,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];if(n=n||t.length,e)for(o=0;o<e;o++)r[o]=t[0|Math.random()*n];else{var a;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",o=0;o<36;o++)r[o]||(a=0|16*Math.random(),r[o]=t[19==o?3&a|8:a])}return r.join("")}function getShowTimes(e){var n=new Date;return Math.round((n.getTime()-e)/1e3)}$(function(){var e=getRequestByName("sign"),n="",o=get_uuid(),t=(new Date).getTime(),r=window.location.href;$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/enter",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{company:"rise",userId:o,sign:e,flag:2},dataType:"json",success:function(e){console.log(e)},error:function(e){console.log(e)}});var a=window.setInterval(function(){var n=getShowTimes(t);n<=180?$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/stay",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{company:"rise",url:r,sign:e,userId:o,totalTime:n,otherInfo:""},dataType:"json",success:function(e){},error:function(e){console.log(e)}}):window.clearInterval(a)},1e3);$("#submit").click(function(){var t=$.trim($("#phone").val()),r=$.trim($("#code").val()),a=!0;""==t?(a=!1,$("#phone").parents(".form-item").addClass("error").find(".message").html("请正确输入")):checkPhone(t)?$("#phone").parents(".form-item").removeClass("error"):(a=!1,$("#phone").parents(".form-item").addClass("error").find(".message").html("请正确输入")),$(".main-form .form-item").eq(1).is(":hidden")||""!=r?r!=n?(a=!1,$("#code").parents(".form-item").addClass("error").find(".message").html("验证码错误")):$("#code").parents(".form-item").removeClass("error"):(a=!1,$("#code").parents(".form-item").addClass("error").find(".message").html("请输入验证码")),a&&$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/info",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{company:"rise",userId:o,phone:t,name:name,age:0,gender:0,school:"",sign:e},dataType:"json",success:function(e){console.log(e),$(".modal-form").hide(),$(".modal").show(),$(".main .form-text input").val("")},error:function(e){console.log(e)}})}),$(".modal").click(function(){$(this).hide()}),$(".modal-form").click(function(){$(this).hide()}),$(".modal-form .main-form").click(function(e){(e=e||window.event).stopPropagation()}),$(".main").on("touchstart",function(){var e=event.targetTouches[0],n=Math.round(e.pageX),t=Math.round(e.pageY),a=$(".main").width(),i=$(".main").height(),s=Math.round(540*n/a),c=Math.round(540*t/a);$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/clickCount",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{company:"rise",url:r,userId:o,coordinate:s+","+c,otherInfo:"x: "+n+",y: "+t+",w:"+a+",h:"+i},dataType:"json",success:function(e){},error:function(e){console.log(e)}})});var i=0;i=/Android|iPhone|BlackBerry/i.test(navigator.userAgent)?1:0,$(".main-form").on("click","input",function(){$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/click",data:{sign:e,uuid:o,deviceType:i,clickType:1,company:"rise",userId:o,otherInfo:""},success:function(e){},error:function(e){console.log(e)}})}),$(".main-form").on("input","#phone",function(){var n=$(this).val();checkPhone(n)&&($("#getcode").removeClass("disabled"),$(this).parents(".form-item").removeClass("error")),$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/click",data:{sign:e,uuid:o,deviceType:i,clickType:2,company:"rise",userId:o,otherInfo:n},success:function(e){},error:function(e){console.log(e)}})}),$(".main-form").on("click","button",function(){$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/click",data:{sign:e,uuid:o,deviceType:i,clickType:3,company:"rise",userId:o,otherInfo:"#submit"},success:function(e){},error:function(e){console.log(e)}})}),$("#register").click(function(){$(".modal-form").show(),$(".main-form .form-text input").val(""),$(".main-form .form-text a").addClass("disabled").show(),$(".main-form .form-item").eq(1).hide(),$.ajax({type:"POST",url:"https://mm.jnrise.cn:88/loading/server/click",data:{sign:e,uuid:o,deviceType:i,clickType:3,company:"rise",userId:o,otherInfo:"#register"},success:function(e){},error:function(e){console.log(e)}})}),$("#getcode").click(function(){if(!$(this).hasClass("disabled")){$(this).hide(),$(".main-form .form-item").eq(1).show();var e=60;$("#getcode2").html(e+"s"),a=setInterval(function(){e--,$("#getcode2").html(e+"s"),0==e&&(clearInterval(a),$("#getcode2").removeClass("disabled").html("重新获取"))},1e3);var o=$.trim($("#phone").val());$.ajax({type:"GET",url:"https://mm.jnrise.cn:88/loading/server/sms",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{mobile:o},dataType:"json",success:function(e){n=0==e.code?e.message:""},error:function(e){console.log(e)}})}}),$("#getcode2").click(function(){$("#getcode2").addClass("disabled");var e=60;$("#getcode2").html(e+"s"),a=setInterval(function(){$("#getcode2").html(e+"s"),0==--e&&(clearInterval(a),$("#getcode2").removeClass("disabled").html("重新获取"))},1e3);var o=$.trim($("#phone").val());$.ajax({type:"GET",url:"https://mm.jnrise.cn:88/loading/server/sms",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{mobile:o},dataType:"json",success:function(e){n=0==e.code?e.message:""},error:function(e){console.log(e)}})})});